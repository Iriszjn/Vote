<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>活动实时反馈 / Event Live Feedback</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: #333; margin: 0; padding: 20px 15px; display: flex; justify-content: center; align-items: center; min-height: 100vh; box-sizing: border-box; }
        .container { width: 100%; max-width: 600px; background: rgba(255, 255, 255, 0.95); padding: 30px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15); backdrop-filter: blur(10px); }
        h1 { font-size: 1.8em; color: #3f51b5; text-align: center; margin: 0 0 25px 0; line-height: 1.3; }
        .form-section { margin-bottom: 25px; }
        .question-title { font-size: 1.1em; font-weight: 600; margin-bottom: 15px; color: #555; line-height: 1.4; }
        .optional-tag { font-size: 0.8em; font-weight: normal; color: #999; }
        .options-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .options-grid label, .checkbox-group label { cursor: pointer; padding: 12px 5px; border-radius: 10px; background-color: #f1f3f5; border: 1px solid #dee2e6; font-size: 1em; transition: all 0.2s ease-in-out; text-align: center; line-height: 1.3; display: block; }
        .lang-en { display: block; font-size: 0.8em; color: #555; margin-top: 2px; }
        input[type="radio"], input[type="checkbox"] { display: none; }
        input[type="radio"]:checked + label, input[type="checkbox"]:checked + label { background-color: #4c6ef5; color: white; border-color: #4c6ef5; transform: scale(1.05); box-shadow: 0 4px 12px rgba(76, 110, 245, 0.4); }
        input[type="radio"]:checked + label .lang-en, input[type="checkbox"]:checked + label .lang-en { color: #e0e0e0; }
        input[type="text"], textarea { width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 8px; font-size: 1em; margin-top: 5px; box-sizing: border-box; transition: border-color 0.3s, box-shadow 0.3s; }
        input[type="text"]:focus, textarea:focus { border-color: #4c6ef5; box-shadow: 0 0 0 3px rgba(76, 110, 245, 0.2); outline: none; }
        button#submit-btn { display: block; width: 100%; padding: 15px; background: linear-gradient(45deg, #4776e6, #8e54e9); color: white; border: none; border-radius: 10px; font-size: 1.2em; font-weight: bold; cursor: pointer; transition: transform 0.2s, box-shadow 0.2s; margin-top: 15px; }
        button#submit-btn:hover { transform: translateY(-3px); box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2); }
        .checkbox-group { display: flex; flex-direction: column; gap: 10px; }
        fieldset { border: 1px solid #ddd; border-radius: 8px; padding: 15px; margin-bottom: 15px; }
        legend { font-weight: 500; color: #333; padding: 0 10px; }
        .other-option { display: flex; align-items: center; gap: 10px; margin-top: 10px; }
        .other-option label { flex-shrink: 0; }
    </style>
</head>
<body>
    <div class="container">
        <form id="feedback-form">
            <h1>活动实时反馈<br><span class="lang-en" style="font-size:0.7em; font-weight:normal;">Event Live Feedback</span></h1>
            
            <!-- Question 1 -->
            <div class="form-section">
                <div class="question-title">1. 您对本次科技周的整体感受如何？<br><span class="lang-en">How do you feel about this Tech Week overall?</span></div>
                <div class="options-grid">
                    <input type="radio" id="q1-opt1" name="satisfaction" value="非常棒"><label for="q1-opt1">🎉 非常棒<br><span class="lang-en">Excellent</span></label>
                    <input type="radio" id="q1-opt2" name="satisfaction" value="还不错"><label for="q1-opt2">👍 还不错<br><span class="lang-en">Good</span></label>
                    <input type="radio" id="q1-opt3" name="satisfaction" value="一般般"><label for="q1-opt3">🙂 一般般<br><span class="lang-en">Average</span></label>
                    <input type="radio" id="q1-opt4" name="satisfaction" value="有待改进"><label for="q1-opt4">🤔 有待改进<br><span class="lang-en">Needs Improvement</span></label>
                </div>
            </div>

            <!-- Question 2 -->
            <div class="form-section">
                <div class="question-title">2. 如果用一个词来形容本次科技周，它会是？<br><span class="lang-en">If you could use one word to describe it, what would it be?</span></div>
                <input type="text" id="wordcloud-text" placeholder="例如：前沿、启发、有趣... / e.g., Inspiring, Fun...">
            </div>

            <!-- Question 3 -->
            <div class="form-section">
                <div class="question-title">3. 听完分享，您最想立即在工作或生活中尝试哪些应用？ (可多选)<br><span class="lang-en">What applications are you most eager to try? (Multiple selections)</span></div>
                <div class="checkbox-group">
                    <fieldset>
                        <legend>专业开发提效 / Professional Dev Tools</legend>
                        <input type="checkbox" id="q3-opt1" name="q3-options" value="Dify"><label for="q3-opt1">Dify <span class="lang-en">LLM App Dev Platform</span></label>
                        <input type="checkbox" id="q3-opt2" name="q3-options" value="M365 Copilot"><label for="q3-opt2">M365 Copilot <span class="lang-en">AI Work Assistant</span></label>
                        <input type="checkbox" id="q3-opt3" name="q3-options" value="Cursor"><label for="q3-opt3">Cursor <span class="lang-en">AI-First Code Editor</span></label>
                    </fieldset>
                    <fieldset>
                        <legend>创意与生活应用 / Creative & Lifestyle Apps</legend>
                        <input type="checkbox" id="q3-opt4" name="q3-options" value="AI 音乐生成 (Suno)"><label for="q3-opt4">AI 音乐生成 (Suno)<span class="lang-en">AI Music Generation</span></label>
                        <input type="checkbox" id="q3-opt5" name="q3-options" value="AI 图像生成 (Midjourney)"><label for="q3-opt5">AI 图像生成 (Midjourney)<span class="lang-en">AI Image Generation</span></label>
                        <input type="checkbox" id="q3-opt6" name="q3-options" value="AI 视频生成 (Pika)"><label for="q3-opt6">AI 视频生成 (Pika)<span class="lang-en">AI Video Generation</span></label>
                    </fieldset>
                    <div class="other-option">
                        <input type="checkbox" id="q3-other-check" name="q3-options" value="其他"><label for="q3-other-check">其他<span class="lang-en">Other</span></label>
                        <input type="text" id="q3-other-text" placeholder="请补充 / Please specify...">
                    </div>
                </div>
            </div>

            <!-- Question 4 -->
            <div class="form-section">
                <div class="question-title">4. 对于未来的AI培训，您最感兴趣的方向是？ (可多选)<br><span class="lang-en">For future AI training, which topics interest you most? (Multiple selections)</span></div>
                <div class="checkbox-group">
                    <input type="checkbox" id="q4-opt1" name="q4-options" value="AI 工具提效 (ChatGPT/Gemini)"><label for="q4-opt1">AI 工具提效 (ChatGPT/Gemini)<span class="lang-en">AI Tool Proficiency</span></label>
                    <input type="checkbox" id="q4-opt2" name="q4-options" value="AI Agent 技术 (AutoGen/CrewAI)"><label for="q4-opt2">AI Agent 技术 (AutoGen/CrewAI)<span class="lang-en">AI Agent Tech</span></label>
                    <input type="checkbox" id="q4-opt3" name="q4-options" value="AI 行业案例与趋势"><label for="q4-opt3">AI 行业案例与趋势<span class="lang-en">Industry Cases & Trends</span></label>
                    <input type="checkbox" id="q4-opt4" name="q4-options" value="AI 赋能业务增长"><label for="q4-opt4">AI 赋能业务增长<span class="lang-en">AI for Business Growth</span></label>
                    <input type="checkbox" id="q4-opt5" name="q4-options" value="AI 技术原理入门"><label for="q4-opt5">AI 技术原理入门<span class="lang-en">AI Fundamental Principles</span></label>
                    <div class="other-option">
                        <input type="checkbox" id="q4-other-check" name="q4-options" value="其他"><label for="q4-other-check">其他<span class="lang-en">Other</span></label>
                        <input type="text" id="q4-other-text" placeholder="请补充 / Please specify...">
                    </div>
                </div>
            </div>

            <!-- Question 5 -->
            <div class="form-section">
                <div class="question-title">5. 任何其他的建议或想法？ <span class="optional-tag">(选填 / Optional)</span><br><span class="lang-en">Any other suggestions or ideas?</span></div>
                <textarea id="suggestion-text" rows="4" placeholder="您的建议是我们进步的动力 / Your suggestions help us improve..."></textarea>
            </div>
            
            <button id="submit-btn" type="button" onclick="submitFeedback()">提 交 / SUBMIT</button>
        </form>
    </div>

    <script src="//cdn.jsdelivr.net/npm/leancloud-storage/dist/av-live-query-min.js"></script>
    <script>
        AV.init({
            appId: "Slv3fGdSSxRZxOzM5la2ZCyD-gzGzoHsz",
            appKey: "XcUAt5yfUPWQlEpLBdXLcJHW",
            serverURL: "https://slv3fgds.lc-cn-n1-shared.com"
        });

        // 定义新的LeanCloud数据表
        const InterestApplication = AV.Object.extend('InterestApplication');
        const TrainingInterest = AV.Object.extend('TrainingInterest');
        const Satisfaction = AV.Object.extend('Satisfaction');
        const WordCloud = AV.Object.extend('WordCloud');
        const Suggestion = AV.Object.extend('Suggestion');

        function getCheckboxValues(name, otherCheckId, otherTextId) {
            const checked = document.querySelectorAll(`input[name="${name}"]:checked`);
            const values = [];
            checked.forEach(checkbox => {
                if (checkbox.id === otherCheckId) {
                    const otherText = document.getElementById(otherTextId).value.trim();
                    if (otherText) values.push(`其他: ${otherText}`);
                } else {
                    values.push(checkbox.value);
                }
            });
            return values;
        }

        async function submitFeedback() {
            const submitBtn = document.getElementById('submit-btn');
            submitBtn.disabled = true;
            submitBtn.textContent = '提交中... / Submitting...';

            try {
                // 获取所有表单值
                const satisfactionOption = document.querySelector('input[name="satisfaction"]:checked');
                const wordcloudText = document.getElementById('wordcloud-text').value.trim();
                const interestValues = getCheckboxValues('q3-options', 'q3-other-check', 'q3-other-text');
                const trainingValues = getCheckboxValues('q4-options', 'q4-other-check', 'q4-other-text');
                const suggestionText = document.getElementById('suggestion-text').value.trim();

                // 验证
                if (!satisfactionOption) { alert('请完成第1题：选择您的满意度！\nPlease complete Q1: Select your satisfaction level!'); return; }
                if (!wordcloudText) { alert('请完成第2题：用一个词语描述您的感受！\nPlease complete Q2: Describe your feeling in one word!'); return; }
                if (interestValues.length === 0) { alert('请完成第3题：选择您想尝试的应用！\nPlease complete Q3: Select applications you want to try!'); return; }
                if (trainingValues.length === 0) { alert('请完成第4题：选择您感兴趣的培训方向！\nPlease complete Q4: Select training interests!'); return; }

                const promises = [];

                // 1. 保存满意度
                const satisfaction = new Satisfaction();
                satisfaction.set('vote', satisfactionOption.value);
                promises.push(satisfaction.save());

                // 2. 保存词云
                const wordCloud = new WordCloud();
                wordCloud.set('word', wordcloudText);
                promises.push(wordCloud.save());
                
                // 3. 保存想尝试的应用 (数组)
                const interestApplication = new InterestApplication();
                interestApplication.set('selections', interestValues);
                promises.push(interestApplication.save());

                // 4. 保存培训兴趣 (数组)
                const trainingInterest = new TrainingInterest();
                trainingInterest.set('selections', trainingValues);
                promises.push(trainingInterest.save());

                // 5. 保存建议
                if (suggestionText) {
                    const suggestion = new Suggestion();
                    suggestion.set('text', suggestionText);
                    promises.push(suggestion.save());
                }
                
                // 并发保存所有数据
                await Promise.all(promises);

                document.getElementById('feedback-form').reset();
                alert('感谢您的参与！反馈已成功提交。\nThank you! Your feedback has been submitted successfully.');

            } catch (error) {
                console.error("提交失败 / Submission failed:", error);
                alert('提交失败，请稍后重试。\nSubmission failed, please try again later.');
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = '提 交 / SUBMIT';
            }
        }
    </script>
</body>
</html>
